(function(e){function n(n){for(var a,r,s=n[0],c=n[1],u=n[2],l=0,p=[];l<s.length;l++)r=s[l],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);f&&f(n);while(p.length)p.shift()();return i.push.apply(i,u||[]),t()}function t(){for(var e,n=0;n<i.length;n++){for(var t=i[n],a=!0,r=1;r<t.length;r++){var s=t[r];0!==o[s]&&(a=!1)}a&&(i.splice(n--,1),e=c(c.s=t[0]))}return e}var a={},r={app:0},o={app:0},i=[];function s(e){return c.p+"wps/js/"+({}[e]||e)+"."+{"chunk-201a6952":"f0ecdef6","chunk-2d0da6e1":"c96eb3ec","chunk-51c15022":"c26404a0"}[e]+".js"}function c(n){if(a[n])return a[n].exports;var t=a[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,c),t.l=!0,t.exports}c.e=function(e){var n=[],t={"chunk-201a6952":1,"chunk-51c15022":1};r[e]?n.push(r[e]):0!==r[e]&&t[e]&&n.push(r[e]=new Promise((function(n,t){for(var a="css/"+({}[e]||e)+"."+{"chunk-201a6952":"cef4b6f3","chunk-2d0da6e1":"31d6cfe0","chunk-51c15022":"7abcbf3c"}[e]+".css",o=c.p+a,i=document.getElementsByTagName("link"),s=0;s<i.length;s++){var u=i[s],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===a||l===o))return n()}var p=document.getElementsByTagName("style");for(s=0;s<p.length;s++){u=p[s],l=u.getAttribute("data-href");if(l===a||l===o)return n()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=n,f.onerror=function(n){var a=n&&n.target&&n.target.src||o,i=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=a,delete r[e],f.parentNode.removeChild(f),t(i)},f.href=o;var d=document.getElementsByTagName("head")[0];d.appendChild(f)})).then((function(){r[e]=0})));var a=o[e];if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((function(n,t){a=o[e]=[n,t]}));n.push(a[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=s(e);var p=new Error;u=function(n){l.onerror=l.onload=null,clearTimeout(f);var t=o[e];if(0!==t){if(t){var a=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;p.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",p.name="ChunkLoadError",p.type=a,p.request=r,t[1](p)}o[e]=void 0}};var f=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(n)},c.m=e,c.c=a,c.d=function(e,n,t){c.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,n){if(1&n&&(e=c(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(c.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)c.d(t,a,function(n){return e[n]}.bind(null,a));return t},c.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(n,"a",n),n},c.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},c.p="/",c.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=n,u=u.slice();for(var p=0;p<u.length;p++)n(u[p]);var f=l;i.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"534e":function(e,n,t){"use strict";t("c975"),t("baa5"),t("d3b7"),t("25f0");var a={msoCTPDockPositionLeft:0,msoCTPDockPositionRight:2};function r(){var e=document.location.toString();return-1!=(e=decodeURI(e)).indexOf("/")&&(e=e.substring(0,e.lastIndexOf("/"))),e}n["a"]={WPS_Enum:a,GetUrlPath:r}},"56d7":function(e,n,t){"use strict";t.r(n);t("d3b7"),t("e623"),t("e379"),t("5dc8"),t("37e1");var a=t("2b0e"),r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("router-view")],1)},o=[],i={name:"app"},s=i,c=t("2877"),u=Object(c["a"])(s,r,o,!1,null,null,null),l=u.exports,p=t("8c4f"),f=(t("c975"),t("a15b"),t("baa5"),t("c19f"),t("ace4"),t("25f0"),t("5cc6"),t("9a8c"),t("a975"),t("735e"),t("c1ac"),t("d139"),t("3a7b"),t("d5d6"),t("82f8"),t("e91f"),t("60bd"),t("5f96"),t("3280"),t("3fcc"),t("ca91"),t("25a1"),t("cd26"),t("3c5d"),t("2954"),t("649e"),t("219c"),t("170b"),t("b39a"),t("72f7"),t("53ca")),d=t("534e"),g=t("5d66"),v=t.n(g),m={OADocSave:1,NoneOADocSave:0},w={DLM_LocalDoc:0,DLM_OnlineDoc:1};function b(e){return"object"!=Object(f["a"])(wps.ribbonUI)&&(wps.ribbonUI=e),"object"!=Object(f["a"])(wps.Enum)&&(wps.Enum=d["a"].WPS_Enum),window.dispatcher=D,window.OnOpenOnLineDocSuccess=N,window.OnOpenOnLineDocDownFail=T,window.OnUploadToServerSuccess=K,window.OnUploadToServerFail=z,wps.PluginStorage.setItem("EnableFlag",!1),!0}function h(e){var n=e.Id;switch(n){case"btnShowMsg":var t=wps.WpsApplication().ActiveDocument;if(!t)return void alert("当前没有打开任何文档");alert(t.Name);break;case"btnIsEnbable":var a=wps.PluginStorage.getItem("EnableFlag");wps.PluginStorage.setItem("EnableFlag",!a),wps.ribbonUI.InvalidateControl("btnIsEnbable"),wps.ribbonUI.InvalidateControl("btnShowDialog"),wps.ribbonUI.InvalidateControl("btnShowTaskPane");break;case"btnShowDialog":wps.ShowDialog(d["a"].GetUrlPath()+"dialog","这是一个对话框网页",400*window.devicePixelRatio,400*window.devicePixelRatio,!1);break;case"btnShowTaskPane":var r=wps.PluginStorage.getItem("taskpane_id");if(r){var o=wps.GetTaskPane(r);o.Visible=!o.Visible}else{var i=wps.CreateTaskPane(d["a"].GetUrlPath()+"taskpane"),s=i.ID;wps.PluginStorage.setItem("taskpane_id",s),i.Visible=!0}break;case"btnWebNotify":var c=new Date,u=c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();wps.OAAssist.WebNotify("这行内容由wps加载项主动送达给业务系统，可以任意自定义, 比如时间值:"+u);break;case"btnContent":var l=wps.WpsApplication().ActiveDocument;alert("保存文档方法：wps.WpsApplication().ActiveDocument.Save()"),alert("获取文件名："+l.Name),alert("获取文件路径："+l.FullName),alert("获取服务器路径："+window.document.location.href);break;case"btnSaveToServer":$();break;case"btnSaveAsFile":S();break;default:break}return!0}function S(){var e=wps.WpsApplication().ActiveDocument;if(e){var n=wps.WpsApplication().FileDialog(2);n.InitialFileName=e.Name,-1==n.Show()&&n.Execute()}else alert("WPS当前没有可操作文档！")}function D(e){for(var n=0;n<e.length;n++){var t=e[n];for(var a in t)"OpenDoc"===a||"OnlineEditDoc"===a?O(t[a]):"OnlineReadOnlyDoc"===a?F(t[a]):"getDocumentName"===a&&A()}return{message:"ok",app:wps.WpsApplication().Name}}function A(){wps.WpsApplication().ActiveDocument&&alert(wps.WpsApplication().ActiveDocument.Name)}function O(e){""==e.fileName?(wps.PluginStorage.setItem("Save2OAShowConfirm",!0),U(e)):""==e.groundDocLandMode||null==e.groundDocLandMode?I(e,!1):I(e,!0)}function y(e,n,t){var a=t;return j(e,n),x(e,1==a?w.DLM_OnlineDoc:w.DLM_LocalDoc),W(),E(),wps.WpsApplication().Activate(),e}function I(e,n){if(e){var t,a=e.fileName;return a&&n?(wps.WpsApplication().Documents.OpenFromUrl(a,"OnOpenOnLineDocSuccess","OnOpenOnLineDocDownFail"),t=wps.WpsApplication().ActiveDocument,y(t,e,n)):a&&!n&&0==a.indexOf("http")&&P(a,(function(r){if(""==r)return alert("从服务端下载路径："+a+"\n获取文件下载失败！"),null;wps.WpsApplication().Documents.Open(r,!1,!1,!1),t=wps.WpsApplication().ActiveDocument,y(t,e,n)})),t}}function P(e,n){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a=C(t,e),r=wps.Env.GetTempPath()+"/"+a,o=new FileReader;o.onload=function(){wps.FileSystem.writeAsBinaryString(r,o.result),n(r)},o.readAsBinaryString(t.response)}},t.open("GET",e),t.responseType="blob",t.send()}function k(e,n){var t=e.indexOf(n);return e=e.substring(t+n.length),e}function C(e,n){var t=e.getResponseHeader("Content-Disposition"),a="";if(t){var r=k(t,"filename=");a=r?decodeURIComponent(r):"petro"+Date.getTime()}else a=n.substring(n.lastIndexOf("/")+1);return a}function F(e){if(e){var n,t=e.fileName;return t&&(wps.WpsApplication().Documents.OpenFromUrl(t,"OnOpenOnLineDocSuccess","OnOpenOnLineDocDownFail"),n=wps.WpsApplication().ActiveDocument),y(n,e,!0),n}}function N(e){console.log(e)}function T(){alert("打开在线不落地文档失败！请尝试重新打开。")}function W(e){console.log(e)}function U(e){var n=wps.WpsApplication();wps.PluginStorage.setItem("IsInCurrOADocOpen",!0);var t=n.Documents.Add();return wps.PluginStorage.setItem("IsInCurrOADocOpen",!1),j(t,e),x(t,w.DLM_LocalDoc),E(),wps.WpsApplication().Activate(),t}function E(){var e=wps.WpsApplication().ActiveDocument;M(e),_(),setTimeout(L,500)}function L(){wps.ribbonUI&&wps.ribbonUI.ActivateTab("WPSWorkExtTab")}function _(){wps.PluginStorage.setItem("ShowOATabDocActive",H()),wps.ribbonUI.Invalidate()}function M(e){if(e){var n=!1;if(n=H(e),1==n){var t=V(e,"userName");if(""!=t)return void(wps.WpsApplication().UserName=t)}wps.WpsApplication().UserName=wps.PluginStorage.getItem("WPSInitUserName")}}function x(e,n){if(e){var t=wps.PluginStorage.getItem(e.DocID),a=JSON.parse(t);a.groundDocLandMode=n;var r=JSON.stringify(a);wps.PluginStorage.setItem(e.DocID,r)}}function j(e,n){if(e){var t=n;if(e){var a=JSON.stringify(t);wps.PluginStorage.setItem(e.DocID,a)}}}function R(e){var n=e.Id;switch(n){case"btnShowMsg":return"images/1.svg";case"btnShowDialog":return"images/2.svg";case"btnShowTaskPane":return"images/3.svg";case"btnContent":return"images/5.svg";case"btnSaveToServer":return"images/w_Save.png";case"btnSaveAsFile":return"images/w_SaveAs.png";default:}return"images/newFromTemp.svg"}function B(e){var n=e.Id;switch(n){case"btnShowMsg":return!0;case"btnShowDialog":var t=wps.PluginStorage.getItem("EnableFlag");return t;case"btnShowTaskPane":var a=wps.PluginStorage.getItem("EnableFlag");return a;default:break}return!0}function G(e){var n=e.Id;return console.log(n),!0}function q(e){var n=e.Id;switch(n){case"btnIsEnbable":var t=wps.PluginStorage.getItem("EnableFlag");return t?"按钮Disable":"按钮Enable"}return""}function H(){var e=wps.WpsApplication().ActiveDocument;return!!e}function J(e){if(!e)return!1;var n=V(e,"openType");if(""==n)return!1;try{if(-1!=n.protectType)return!0}catch(t){return!1}}function V(e,n){if(!e)return"";var t=wps.PluginStorage.getItem(e.DocID);if(!t)return"";var a=JSON.parse(t);if("undefined"==typeof a)return"";var r=a[n];return"undefined"==typeof r||null==r?"":r}function X(e){var n=V(e,"groundDocLandMode");return""!=n&&n==w.DLM_OnlineDoc}function $(){var e=wps.WpsApplication().ActiveDocument;if(e)if(0!=H())if(J(e))wps.alert("系统设置了保护的文档，不能再提交到系统后台。");else{var n=V(e,"uploadPath");if(""!=n){var t=wps.PluginStorage.getItem("Save2OAShowConfirm");if(!t||wps.confirm("先保存文档，并开始上传到系统后台，请确认？")){var a=V(e,"uploadFieldName");""==a&&(a=wps.PluginStorage.getItem("DefaultUploadFieldName"));var r=V(e,"uploadFileName");""==r&&(r=e.Name);var o=e.FullName;if(0==X(e)){wps.PluginStorage.setItem("OADocUserSave",m.OADocSave),e.Save(),wps.PluginStorage.setItem("OADocUserSave",m.NoneOADocSave);try{ne(r,o,n,a,Q,Z)}catch(s){alert("上传文件失败！请检查系统上传参数及网络环境！")}}else if(wps.WpsApplication().BuildFull.indexOf(".8.")>-1){wps.PluginStorage.setItem("OADocUserSave",m.OADocSave);try{e.SaveAsUrl(r,n,a,"OnUploadToServerSuccess","OnUploadToServerFail")}catch(s){alert("上传文件失败！请检查系统上传参数及网络环境，重新上传。")}wps.PluginStorage.setItem("OADocUserSave",m.NoneOADocSave)}else wps.WpsApplication().BuildFull.indexOf(".1.")>-1&&alert("上传失败！个人版暂不支持此功能，请下载企业版重试。");var i=V(e,"suffix");if(""!=i)V(e,"uploadWithAppendPath");else console.log("上传需转换的文件后缀名错误，无法进行转换上传!")}}else wps.alert("系统未传入文件上载路径，不能执行上传操作！")}else alert("非系统打开的文档，不能直接上传到系统！");else alert("空文档不能保存！")}function K(e){console.log(e);var n=wps.WpsApplication().ActiveDocument;0==wps.confirm("文件上传成功！继续编辑请确认，取消关闭文档。")&&n&&(console.log("OnUploadToServerSuccess: before Close"),n.Close(-1),console.log("OnUploadToServerSuccess: after Close"))}function z(e){alert("文件上传失败！错误信息："+e)}function Q(e){ee(e);var n=wps.WpsApplication().ActiveDocument;if(0==wps.confirm("文件上传成功！继续编辑请确认，取消关闭文档。")&&n){var t=n.FullName;n.Close(-1),Y(t)}}function Y(e){wps.FileSystem.Remove(e)}function Z(e){var n="";n=ee(e),alert("保存失败\nNaN"+ +JSON.stringify(n))}function ee(e){var n="";return e.Body,n}function ne(e,n,t,a,r,o){var i=new XMLHttpRequest;i.open("POST",t);var s=wps.FileSystem.readAsBinaryString(n),c=new FakeFormData;if(""!=a&&"undefined"!=typeof a||(a="file"),c.append(a,{name:ae(e),type:"application/octet-stream",getAsBinary:function(){return s}}),i.onreadystatechange=function(){4==i.readyState&&(200==i.status?r(i.response):o(i.response))},i.setRequestHeader("Cache-Control","no-cache"),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.fake){i.setRequestHeader("Content-Type","multipart/form-data; boundary="+c.boundary);var u=te(c.toString());i.send(u)}else i.send(c)}function te(e){var n,t,a;n=e.length,t=new ArrayBuffer(n),a=new Uint8Array(t);for(var r=0;r<n;++r)a[r]=String.prototype.charCodeAt.call(e,r);return t}function ae(e){if(e){var n,t,a=[],r=e.length;for(n=0;n<r;n++)t=e.charCodeAt(n),t>0&&t<=127?a.push(e.charAt(n)):t>=128&&t<=2047?a.push(String.fromCharCode(192|t>>6&31),String.fromCharCode(128|63&t)):t>=2048&&t<=65535&&a.push(String.fromCharCode(224|t>>12&15),String.fromCharCode(128|t>>6&63),String.fromCharCode(128|63&t));return a.join("")}}var re={OnAddinLoad:b,OnAction:h,GetImage:R,OnGetEnabled:B,OnGetVisible:G,OnGetLabel:q,dispatcher:D,Formdata:v.a};a["a"].use(p["a"]),a["a"].config.productionTip=!1;var oe=[{path:"/",name:"默认页",component:function(){return t.e("chunk-2d0da6e1").then(t.bind(null,"6c20"))}},{path:"/dialog",name:"对话框",component:function(){return t.e("chunk-51c15022").then(t.bind(null,"3f7a"))}},{path:"/taskpane",name:"任务窗格",component:function(){return t.e("chunk-201a6952").then(t.bind(null,"8e61"))}}];new a["a"]({render:function(e){return e(l)},router:new p["a"]({routes:oe}),created:function(){window.ribbon=re}}).$mount("#app")},"5d66":function(e,n,t){t("4160"),t("b0c0"),t("d3b7"),t("25f0"),t("159b"),function(e){function n(){this.fake=!0,this.boundary="--------FormData"+Math.random(),this._fields=[]}e.FakeFormData||(n.prototype.append=function(e,n){this._fields.push([e,n])},n.prototype.toString=function(){var e=this.boundary,n="";return this._fields.forEach((function(t){if(n+="--"+e+"\r\n",t[1].name){var a=t[1];n+='Content-Disposition: form-data; name="'+t[0]+'"; filename="'+a.name+'"\r\n',n+="Content-Type: "+a.type+"\r\n\r\n",n+=a.getAsBinary()+"\r\n"}else n+='Content-Disposition: form-data; name="'+t[0]+'";\r\n\r\n',n+=t[1]+"\r\n"})),n+="--"+e+"--",n},e.FakeFormData=n)}(window)}});
//# sourceMappingURL=app.9ba8169b.js.map